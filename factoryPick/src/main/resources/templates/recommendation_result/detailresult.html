<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" th:href="@{/css/detailresult-vars.css}">
  <link rel="stylesheet" th:href="@{/css/detailresult-style.css}">
	<script th:src="@{/script/authStatus.js}" defer></script>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <title>Document</title>
</head>

<body>
  <div class="frame-1">
    <div class="rectangle-1"></div>
    <div class="rectangle-7"></div>

    <div class="complex_name_1" id="complexNameDisplay">
      ì‚°ì—…ë‹¨ì§€ëª… <!-- ë°ì´í„°ê°€ ì—†ì„ ë•Œ ê¸°ë³¸ í‘œì‹œ -->
    </div>

    <!-- ì‚°ì—…ë‹¨ì§€ ì´ë¦„ ì¶œë ¥ -->
    <div class="complex_name_1">
      <span id="complexName"></span>
    </div>

    <!-- ì§€ë„ í‘œì‹œ ì˜ì—­ -->
    <div id="map"></div>

    <div class="frame-3">
      <div class="status-text" th:text="${complexInfoDTO.status}"
        style="font-size: 25px; font-weight: bold; color: white; text-align: center;">
      </div>
    </div>

    <div class="div2">ì¤€ê³µì¸ê°€ì¼</div>

    <div class="industry-section">
      <div class="div3">ì—…ì¢…ì§‘ì ë„</div> <!-- ì—…ì¢… ì§‘ì ë„ í…ìŠ¤íŠ¸ -->
      <canvas id="industryPieChart" width="450" height="450"></canvas> <!-- íŒŒì´ì°¨íŠ¸ -->
    </div>



    <div class="rectangle-5">
      <div class="completion-date-label" th:text="${complexInfoDTO.completionDate}">
      </div>
    </div>

    <div class="pie-chart-wrapper">
      <div class="pie-chart">
      </div>
    </div>

	<div class="set">   
	  <div class="div4">ìœ ì¹˜ì—…ì¢…</div>
	  <div class="rectangle-6">
	    <!-- complexInfoDTOê°€ ì¡´ì¬í•˜ê³  industryTypeì´ ìˆì„ ë•Œ -->
	    <div th:if="${complexInfoDTO != null && complexInfoDTO.industryType != null}">
	      <div class="industry_type" th:text="${complexInfoDTO.industryType}">ìœ ì¹˜ì—…ì¢… ì¢…ë¥˜</div>
	    </div>
	    
	    <!-- complexInfoDTOê°€ nullì´ê±°ë‚˜ industryTypeì´ ì—†ì„ ë•Œ -->
	    <div th:if="${complexInfoDTO == null || complexInfoDTO.industryType == null}">
	      <p style="color: red;">ìœ ì¹˜ì—…ì¢… ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
	    </div>
	  </div>
	  
	  <div class="div5">ì„¸ì œí˜œíƒ</div>
	  <div class="button-tax-button"> 
	    <button id="downloadPdfButton" class="download-button">ì„¸ì œí˜œíƒ ë°”ë¡œ í™•ì¸í•˜ê¸° ğŸ”</button>
	  </div> 
	</div>

    <script>
      // ë²„íŠ¼ í´ë¦­ ì‹œ PDF ë‹¤ìš´ë¡œë“œ ì—”ë“œí¬ì¸íŠ¸ë¡œ ì´ë™
      document.getElementById('downloadPdfButton').addEventListener('click', () => {
        window.location.href = "/download-pdf";  // PDF ë‹¤ìš´ë¡œë“œ ìš”ì²­
      });
    </script>

    <div class="div7">êµí†µì •ë³´</div>
    <div class="div8">í•­ê³µ</div>
    <!-- <div class="highway">
        <span th:text="${transInfoDTO.highwayName}">ê³ ì†ë„ë¡œ ì´ë¦„</span><br>
        <span th:text="${transInfoDTO.highwayDistance} + 'km'">0km</span>
   </div> -->

    <div class="highway">
      <span th:text="${highwayInfo}">ê³ ì†ë„ë¡œ ì •ë³´</span>
    </div>


    <div class="group-5"></div>
    <div class="rectangle-8"></div>
    <div class="rectangle-9"></div>
    <div class="rectangle-10"></div>
    <div class="rectangle-11"></div>
    <div class="div10">ê³ ì†ë„ë¡œ</div>
    <div class="div11">ê³ ì†ì² ë„</div>
    <div class="div12">í•­ë§Œ</div>

    <!-- <div class="airport">
        <span th:text="${transInfoDTO.airportName}">ê³µí•­ ì´ë¦„</span><br>
        <span th:text="${transInfoDTO.airportDistance} + 'km'">0km</span>
     </div> -->

    <div class="airport">
      <span th:text="${airportInfo}">ê³µí•­ ì •ë³´</span>
    </div>

    <!-- <div class="seaport">
        <span th:text="${transInfoDTO.seaportName}">í•­ë§Œ ì´ë¦„</span><br>
        <span th:text="${transInfoDTO.seaportDistance} + 'km'">0km</span>
     </div> -->

    <div class="seaport">
      <span th:text="${seaportInfo}">í•­ë§Œ ì •ë³´</span>
    </div>

    <!-- <div class="train">
         <span th:text="${transInfoDTO.stationName}">ì² ë„ ì´ë¦„</span><br>
         <span th:text="${transInfoDTO.stationDistance} + 'km'">0km</span>
      </div> -->

    <div class="train">
      <span th:text="${stationInfo}">ì² ë„ ì •ë³´</span>
    </div>

  
    <div class="group-52">
      <img class="fishing-boat" th:src="@{../images/fishing-boat0.png}" />
      <img class="train_image" th:src="@{../images/train0.png}" />
      <img class="truck" th:src="@{../images/truck0.png}" />
      <img class="airplane-take-off" th:src="@{../images/airplane-take-off0.png}" />
    </div>
    <div class="group-1">
      <div class="button2">
        <a class="recommendation pleaseButtonHover" data-recommendation="recommendation"
          th:href="@{/recommendation/recommendation_intro}">
          ê³µì¥ì…ì§€ ì¶”ì²œ ë°›ê¸°
        </a>
      </div>
      <div class="button3">
        <a class="intro pleaseButtonHover" data-intro="intro" th:href="@{/intro}">ì¶”ì²œì‹œìŠ¤í…œ ì†Œê°œ</a>
      </div>
      <div class="button4">
        <a class="property pleaseButtonHover" data-property="property" th:href="@{/property/intro}">ì‚°ì—…ë‹¨ì§€ ë‘˜ëŸ¬ë³´ê¸°</a>
      </div>
      <div class="button5">
        <a class="myPage pleaseButtonHover" data-my-page="myPage" th:href="@{/FinalModal}">ë§ˆì´í˜ì´ì§€</a>
      </div>
      <div class="button6">
        <a class="support pleaseButtonHover" data-support="suppport" th:href="@{/support}">ê³ ê°ì§€ì›</a>
      </div>
      <div class="button7">
        <div class="users pleaseButtonHover">ì¼ë°˜íšŒì›</div>
      </div>
      <div class="button8">
        <div class="agent pleaseButtonHover">ì¤‘ê°œì¸</div>
      </div>
      <div class="button9">
        <div class="login pleaseButtonHover" id="authButton"><a th:href="@{/login}">ë¡œê·¸ì¸/ íšŒì›ê°€ì…</a></div>
      </div>
    </div>
    <div class="button10">
      <a th:href="@{/}">
        <img class="home pleaseButtonHover" data-mainpage="mainpage" th:src="@{../images/image-20.png}" />
      </a>
    </div>
    <div class="div21">
      <div class="property-1-heart">
      </div>
    </div>

    <div class="frame-4">
      <a href="/mainresult" class="back-link"> <!-- URL ìˆ˜ì • -->
         < ì¶”ì²œ ê²°ê³¼ë¡œ ë˜ëŒì•„ê°€ê¸° </a>
    </div>
    <div class="line-6"></div>
    <div class="div24">ì¤‘ê°œì¸ ì •ë³´</div>
    <div class="rectangle-3"></div>
    <div class="rectangle-32"></div>
    <div class="rectangle-42"></div>
    <div class="div25">ì‚°ì—…ìš©ì§€ í‰ê·  ë¶„ì–‘ê°€</div>
    <div class="div26">í™ê¸¸ë™</div>
    <div class="rectangle-33"></div>
    <div class="div27">ì¤‘ê°œì¸ ì—°ê²° ğŸ”</div>


<div class="land_price" id="landPrice" th:text="'â‚© ' + ${complexInfoDTO.avgPrice} + ' / ã¡'">â‚©</div>
<div class="land_size" id="landSize" th:text="${complexInfoDTO.landSize} + ' ã¡'">ã¡</div>

<script>
  // ìˆ«ìì— ì»´ë§ˆ ì¶”ê°€ í•¨ìˆ˜
  function formatNumberWithCommas(number) {
    return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
  }

  // ì»´ë§ˆ ì¶”ê°€ë¥¼ ìœ„í•œ HTML ìš”ì†Œ ì—…ë°ì´íŠ¸
  const landPriceElement = document.getElementById("landPrice");
  const landSizeElement = document.getElementById("landSize");

  // land_priceì™€ land_size ê°’ì— ëŒ€í•´ ì»´ë§ˆ ì¶”ê°€
  if (landPriceElement) {
    const originalLandPrice = landPriceElement.innerText.replace(/â‚©| \/ ã¡/g, '').trim(); // ìˆ«ìë§Œ ì¶”ì¶œ
    landPriceElement.innerText = 'â‚© ' + formatNumberWithCommas(originalLandPrice) + ' / ã¡';
  }

  if (landSizeElement) {
    const originalLandSize = landSizeElement.innerText.replace(/ã¡/g, '').trim(); // ìˆ«ìë§Œ ì¶”ì¶œ
    landSizeElement.innerText = formatNumberWithCommas(originalLandSize) + ' ã¡';
  }
</script>


    <div class="_010-1234-5678">010-1234-5678</div>
    <div class="_513">ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ì˜ë™ëŒ€ë¡œ 513</div>
    <div class="rectangle-34"></div>
    <!-- <div class="div28">ì‚¬ì´íŠ¸ ë°”ë¡œê°€ê¸° ğŸ‘†</div> -->
    <div class="div28" id="goToSite">ì‚¬ì´íŠ¸ ë°”ë¡œê°€ê¸° ğŸ‘†</div>
    <!-- URL ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ -->
    <div th:if="${urlError != null}">
      <p style="color: red;">[[${urlError}]]</p>
    </div>

    <script th:inline="javascript">
      const websiteUrl = /*[[${websiteUrl}]]*/ "";

      console.log("Website URL:", websiteUrl);  // ë””ë²„ê¹…ìš© ë¡œê·¸

      document.getElementById('goToSite').addEventListener('click', () => {
        if (websiteUrl && websiteUrl.startsWith("http")) {
          window.location.href = websiteUrl;  // í•´ë‹¹ URLë¡œ ì´ë™
        } else {
          alert('ìœ íš¨í•œ URLì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        }
      });
    </script>



    <!-- Kakao ì§€ë„ API ì¶”ê°€ -->
    <script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=1708a916702bd0a90d99218c7d3dbfbd"></script>

    <!-- ì§€ë„ API ìŠ¤í¬ë¦½íŠ¸ -->
    <script>


      let complexData = [];

      //JSON íŒŒì¼ì—ì„œ ì‚°ì—…ë‹¨ì§€ ìœ„ì¹˜ ë°ì´í„°ë¥¼ ë¡œë“œí•©ë‹ˆë‹¤.
      fetch('/script/COMPLEX_POSITION.json')
        .then(response => response.json())
        .then(data => {
          complexData = data;  // ë°ì´í„°ë¥¼ ë³€ìˆ˜ì— ì €ì¥
          initMap();  // ì§€ë„ ì´ˆê¸°í™” í•¨ìˆ˜ í˜¸ì¶œ
        })
        .catch(error => console.error('JSON ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error));

      //URLì—ì„œ ì „ë‹¬ëœ íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ì¶œí•˜ëŠ” í•¨ìˆ˜
      function getQueryParam(param) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param);  // 'name' íŒŒë¼ë¯¸í„° ê°’ì„ ë°˜í™˜
      }

      //ì§€ë„ ì´ˆê¸°í™” í•¨ìˆ˜
      function initMap() {
        const complexName = getQueryParam('name');  // URLì—ì„œ 'name' ê°’ì„ ê°€ì ¸ì˜´
        if (!complexName) {
          alert('ì‚°ì—…ë‹¨ì§€ ì´ë¦„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
          return;
        }

        // ë™ì ìœ¼ë¡œ ì‚°ì—…ë‹¨ì§€ëª…ì„ í‘œì‹œ
        document.getElementById('complexNameDisplay').innerText = complexName;

        // ì§€ë„ ìœ„ì¹˜ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ì„œ ì²˜ë¦¬í•˜ëŠ” ë‚˜ë¨¸ì§€ ë¡œì§
        const complexLocation = complexData.find(complex => complex.complex_name === complexName);  // ì´ë¦„ì´ ì¼ì¹˜í•˜ëŠ” ë°ì´í„°ë¥¼ ì°¾ìŒ

        if (complexLocation) {
          // ì¹´ì¹´ì˜¤ ì§€ë„ ìƒì„± ë° ì„¤ì •
          const mapContainer = document.getElementById('map');
          const mapOption = {
            center: new kakao.maps.LatLng(complexLocation.latitude, complexLocation.longitude),  // ì‚°ì—…ë‹¨ì§€ ì¢Œí‘œ
            level: 6  // ì¤Œ ë ˆë²¨
          };
          const map = new kakao.maps.Map(mapContainer, mapOption);  // ì§€ë„ ìƒì„±

          // ë§ˆì»¤ ìƒì„± ë° ì§€ë„ì— ì¶”ê°€
          const marker = new kakao.maps.Marker({
            position: new kakao.maps.LatLng(complexLocation.latitude, complexLocation.longitude)
          });
          marker.setMap(map);

          // ë§ˆì»¤ì— ì‚°ì—…ë‹¨ì§€ ì´ë¦„ì„ í‘œì‹œí•˜ëŠ” ì¸í¬ìœˆë„ìš° ì¶”ê°€
          const infowindow = new kakao.maps.InfoWindow({
            content: `<div class="custom-info-window" style="
            background-color: #fca311;
            	font-size: 22px; 
                font-weight: bold; 
                text-align: center; 
                padding: 10px;
                border-radius: 8px;
          ">${complexName}</div>`
          });
          infowindow.open(map, marker);
        } else {
          alert('í•´ë‹¹ ì‚°ì—…ë‹¨ì§€ ìœ„ì¹˜ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        }
      }
      
      
    </script>
    <div class="div29">ì‚°ì—…ë‹¨ì§€ ë©´ì </div>

    <div class="complex_name_2" th:text="${complexInfoDTO.complexName}">
      <span id="complexName">ì‚°ì—…ë‹¨ì§€ëª…</span>
      <img class="favorite" src="path_to_favorite_icon.png" alt="favorite icon">
    </div>
    <div class="province" th:text="${province}">ì‚°ì—…ë‹¨ì§€ ìœ„ì¹˜</div>
    <div class="div32">
    </div>
    <img class="circled-user-male-skin-type-6" th:src="@{../images/circled-user-male-skin-type-60.png}" />
    <div class="variant-3">
    </div>

<!-- Chart.js íŒŒì´ì°¨íŠ¸ ìƒì„± ìŠ¤í¬ë¦½íŠ¸ -->
<script th:inline="javascript">
  const complexRatioData = /*[[${complexRatioData}]]*/ {};  // Thymeleaf ë°ì´í„°ë¥¼ JSë¡œ ì „ë‹¬
  console.log('ComplexRatio Data:', complexRatioData);  // ë°ì´í„°ê°€ ì˜¬ë°”ë¥´ê²Œ ì „ë‹¬ë˜ëŠ”ì§€ í™•ì¸

  // ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ì„œ í•©ê³„ë¥¼ ê³„ì‚°
  const rawData = [
    complexRatioData.food || 0,
    complexRatioData.clothing || 0,
    complexRatioData.wood || 0,
    complexRatioData.petrochemical || 0,
    complexRatioData.nonMetal || 0,
    complexRatioData.metal || 0,
    complexRatioData.electronics || 0,
    complexRatioData.trans || 0,
    complexRatioData.other || 0,
    complexRatioData.nonManu || 0
  ];

  // ì „ì²´ í•©ì„ êµ¬í•˜ê³  ê° í•­ëª©ì˜ ë¹„ìœ¨ì„ ê³„ì‚°
  const total = rawData.reduce((acc, value) => acc + value, 0);
  const data = rawData.map(value => value / total);  // 1ë¡œ ì •ê·œí™”ëœ ë°ì´í„° ë°°ì—´

  const ctx = document.getElementById('industryPieChart').getContext('2d');

  new Chart(ctx, {
    type: 'pie',
    data: {
      labels: [
        'ìŒì‹ë£Œ', 'ì„¬ìœ ì˜ë³µ', 'ëª©ì¬ì¢…ì´', 'ì„ìœ í™”í•™', 'ë¹„ê¸ˆì†',
        'ì² ê°•', 'ê¸°ê³„', 'ì „ê¸°ì „ì', 'ìš´ì†¡ì¥ë¹„', 'ê¸°íƒ€', 'ë¹„ì œì¡°ì—…'
      ],
      datasets: [{
        data: data,
        backgroundColor: [
          '#FF5733',  // ë¹¨ê°•-ì£¼í™©
          '#33FF57',  // ì—°ë‘
          '#3357FF',  // íŒŒë‘
          '#FF33A8',  // í•‘í¬
          '#33FFF5',  // ë¯¼íŠ¸
          '#FFC300',  // ë…¸ë‘
          '#DAF7A6',  // ì—°ë‘ë¹›
          '#fca311',
          '#6baed6',  // ë°ì€ í•˜ëŠ˜ìƒ‰
          '#581845',  // ì§„í•œ ë³´ë¼
          '#e5e5e5'
        ],
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      layout: {
        padding: 0
      },
      plugins: {
        legend: { position: 'top' },
        tooltip: {
          callbacks: {
            label: function(context) {
              const value = context.raw;
              const percentage = (value * 100).toFixed(2) + '%';
              return `${context.label}: ${percentage}`;
            }
          }
        }
      }
    }
  });
</script>
    </div>
</body>
<footer class="footer">
    <div class="footer-content">
      <div class="footer-menu">
        <a href="#">ì¶”ì²œ ì‹œìŠ¤í…œ ì†Œê°œ</a>
        <a href="#">ê³µì¥ì…ì§€ ì¶”ì²œë°›ê¸°</a>
        <a href="#">ì‚°ì—…ë‹¨ì§€ ë‘˜ëŸ¬ë³´ê¸°</a>
        <a href="#">ë§ˆì´í˜ì´ì§€</a>
        <a href="#">ë¡œê·¸ì¸ / íšŒì›ê°€ì…</a>
      </div>
      <div class="footer-info">
        <p>ìƒí˜¸: (ì£¼)íŒ©í† ë¦¬í”½ | ëŒ€í‘œ: ì„í•œì†” | ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸: 120-87-61559</p>
        <p>ì£¼ì†Œ: ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ì˜ë™ëŒ€ë¡œ511(ì‚¼ì„±ë™, ë¬´ì—­íšŒê´€ 4703í˜¸) íŒ©í† ë¦¬í”½ ê³ ê°ì„¼í„° 1661-6844</p>
        <p>COPYRIGHTÂ© 2024 FACTORY PICK CORP. ALL RIGHTS RESERVED.</p>
        <p>ì„œë¹„ìŠ¤ ì´ìš©ë¬¸ì˜: 1661-8734 | ì´ë©”ì¼: hanwhasystem@factorypick.com</p>
        <p>íŒ©ìŠ¤: 02-568-4908 | ì„œë¹„ìŠ¤ì œíœ´ë¬¸ì˜: partnership@factorypick.com | ë¶„ì–‘ê´‘ê³  ë¬¸ì˜: ad@factorypick.com</p>
      </div>
      <img src="../images/image-30.png" alt="FactoryPick Logo" class="footer-logo" />
    </div>
  </footer>
</html>